// --- إعدادات نظام الإرسال الآلي (EmailJS) ---
// 1. تفعيل الاتصال باستخدام مفتاحك العام
emailjs.init("I7O-M98m-x4dW5R3t"); 

// 2. دالة استعادة الحساب وإرسال الإيميل
function recoverAccount() {
    const email = prompt("أدخل بريدك الإلكتروني المسجل لارسال كلمة المرور:");
    if (!email) return;

    // البحث في قاعدة بيانات Firebase عن البريد المدخل
    db.ref('users').once('value', snapshot => {
        let foundUser = null;
        snapshot.forEach(child => {
            if (child.val().email === email) {
                foundUser = { name: child.key, pass: child.val().password };
            }
        });

        if (foundUser) {
            alert("جاري التحقق وإرسال البيانات لبريدك الإلكتروني...");

            // إرسال البيانات باستخدام معرف الخدمة ومعرف القالب الخاص بك
            emailjs.send("service_vv75pdh", "template_5glwjdq", {
                to_email: email,
                user_name: foundUser.name,
                user_password: foundUser.pass
            }).then(() => {
                alert("تم الإرسال بنجاح! يرجى تفقد بريدك الإلكتروني الآن.");
            }, (error) => {
                alert("فشل الإرسال، تأكد من إعدادات الربط في EmailJS.");
                console.error("FAILED...", error);
            });
        } else {
            alert("عذراً، هذا البريد الإلكتروني غير موجود في سجلاتنا.");
        }
    });
}
