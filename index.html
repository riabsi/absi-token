<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABSI EXCHANGE | PRO</title>
    <style>
        :root {
            --bg: #0b0e11; --panel: #1e2329; --gold: #f0b90b;
            --buy: #0ecb81; --sell: #f6465d; --text: #eaecef;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body { 
            background-color: var(--bg); color: white; margin: 0;
            font-family: sans-serif; overflow-y: auto;
        }

        header {
            padding: 10px 15px; background: var(--panel);
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 2px solid var(--gold); position: sticky; top: 0; z-index: 100;
        }

        .content { padding: 10px; display: flex; flex-direction: column; gap: 15px; }

        .order-book { 
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px; 
            background: var(--panel); padding: 10px; border-radius: 10px;
        }
        .price-row { display: flex; justify-content: space-between; font-family: monospace; font-size: 0.8rem; margin: 2px 0; }

        .chart-container { 
            height: 350px; background: #000; border-radius: 10px; 
            overflow: hidden; border: 1px solid #333;
        }

        .trade-box { background: var(--panel); padding: 15px; border-radius: 15px; border: 1px solid #444; }
        input { 
            width: 100%; padding: 15px; margin-bottom: 10px; 
            background: #2b3139; border: 1px solid #444; color: white; 
            border-radius: 8px; text-align: center; font-size: 1rem;
        }
        .btn-group { display: flex; gap: 10px; }
        .btn { flex: 1; padding: 15px; border: none; border-radius: 8px; font-weight: bold; color: white; font-size: 1rem; cursor: pointer; transition: 0.2s; }
        .btn:active { transform: scale(0.95); opacity: 0.8; }
        
        .timer-section { text-align: center; padding: 25px 10px; background: rgba(240,185,11,0.08); border-radius: 15px; border: 1px dashed var(--gold); }
        .timer-grid { display: flex; justify-content: center; gap: 10px; margin-top: 15px; }
        .t-box { background: var(--gold); color: black; padding: 10px; border-radius: 8px; min-width: 55px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
        .t-box span { display: block; font-weight: 900; font-size: 1.3rem; }
    </style>
</head>
<body>

    <header>
        <div style="font-size: 0.7rem;">
            <span id="u-mail">جاري التحميل...</span><br>
            <span onclick="logout()" style="color:var(--sell); cursor:pointer;">[خروج]</span>
        </div>
        <div style="color:var(--gold); font-weight:bold; font-size:1.3rem;">ABSI PRO</div>
    </header>

    <div class="content">
        <div class="order-book">
            <div>
                <div style="color:var(--sell); margin-bottom:5px; font-size:0.7rem; font-weight:bold;">طلبات البيع</div>
                <div id="sell-list"></div>
            </div>
            <div>
                <div style="color:var(--buy); margin-bottom:5px; font-size:0.7rem; font-weight:bold;">طلبات الشراء</div>
                <div id="buy-list"></div>
            </div>
        </div>

        <div class="chart-container" id="tv_chart"></div>

        <div class="trade-box">
            <input type="number" id="trade-amount" placeholder="أدخل الكمية USDT">
            <div class="btn-group">
                <button class="btn" style="background:var(--buy)" onclick="handleTrade('شراء')">BUY / شراء</button>
                <button class="btn" style="background:var(--sell)" onclick="handleTrade('بيع')">SELL / بيع</button>
            </div>
        </div>

        <div class="timer-section">
            <div style="color:var(--gold); font-weight:bold; font-size: 1.1rem;">
                قريباً إدراج عملة <span style="color:white; background:#333; padding:2px 8px; border-radius:4px;">ABSI / USDT</span>
            </div>
            <div class="timer-grid">
                <div class="t-box"><span id="d">00</span><small>يوم</small></div>
                <div class="t-box"><span id="h">00</span><small>ساعة</small></div>
                <div class="t-box"><span id="m">00</span><small>دقيقة</small></div>
                <div class="t-box"><span id="s">00</span><small>ثانية</small></div>
            </div>
        </div>
    </div>

    <script src="https://s3.tradingview.com/tv.js"></script>
    <script>
        // التحقق من الدخول
        const user = localStorage.getItem('registeredUser');
        if (!user) { window.location.href = 'login.html'; }
        else { document.getElementById('u-mail').innerText = JSON.parse(user).email; }

        function logout() {
            localStorage.removeItem('registeredUser');
            window.location.href = 'login.html';
        }

        // تفعيل الأزرار
        function handleTrade(type) {
            const amount = document.getElementById('trade-amount').value;
            if (!amount || amount <= 0) {
                alert("يرجى إدخال كمية صالحة للتداول أولاً");
                return;
            }
            alert("⚠️ عذراً!\nرصيدك الحالي 0.00 USDT.\nيرجى إيداع الرصيد في محفظتك أولاً لإتمام عملية الـ " + type);
        }

        // تشغيل الرسم البياني
        new TradingView.widget({
            "autosize": true, "symbol": "BINANCE:BTCUSDT", "interval": "1",
            "theme": "dark", "style": "1", "container_id": "tv_chart", "hide_top_toolbar": true
        });

        // محاكاة الأسعار
        function updatePrices() {
            let s = '', b = '';
            for(let i=0; i<5; i++) {
                s += `<div class="price-row" style="color:var(--sell)"><span>${(96000 + Math.random()*100).toFixed(1)}</span><span>${Math.random().toFixed(2)}</span></div>`;
                b += `<div class="price-row" style="color:var(--buy)"><span>${(95900 - Math.random()*100).toFixed(1)}</span><span>${Math.random().toFixed(2)}</span></div>`;
            }
            document.getElementById('sell-list').innerHTML = s;
            document.getElementById('buy-list').innerHTML = b;
        }
        setInterval(updatePrices, 1500);

        // العداد التنازلي
        const target = new Date("Jan 1, 2026 00:00:00").getTime();
        setInterval(() => {
            const now = new Date().getTime();
            const diff = target - now;
            document.getElementById('d').innerText = Math.floor(diff / (1000 * 60 * 60 * 24));
            document.getElementById('h').innerText = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            document.getElementById('m').innerText = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            document.getElementById('s').innerText = Math.floor((diff % (1000 * 60)) / 1000);
        }, 1000);
    </script>
</body>
</html>
