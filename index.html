<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ABSI Token | Exchange</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#0c1015">
    
    <link rel="apple-touch-icon" href="images/unnamed.jpg">
    <link rel="icon" type="image/jpeg" href="images/unnamed.jpg">

    <style>
        body { 
            background-color: #0c1015; color: #e0e0e0; font-family: 'Arial', sans-serif; 
            margin: 0; height: 100vh; display: flex; flex-direction: column; overflow: hidden; 
        }
        .nav { 
            background: #161a1e; padding: 10px 8px; display: flex; justify-content: space-between;
            align-items: center; border-bottom: 1px solid #2b3139;
        }
        .install-btn {
            background: #ffc107; color: #000; border: none; padding: 5px 10px;
            border-radius: 5px; font-weight: bold; cursor: pointer; display: none; /* يظهر فقط عند الحاجة */
        }
        .container { 
            display: flex; flex-direction: column; gap: 4px; padding: 4px; 
            flex-grow: 1; overflow-y: auto; background-color: #0c1015;
        }
        iframe { border: 1px solid #2b3139; border-radius: 8px; width: 100%; }
        #tradingChart { height: 40vh; }
        #swapWidget { height: 580px; max-width: 450px; margin: 0 auto; }
    </style>
</head>
<body>

<div class="nav">
    <div style="display:flex; align-items:center; gap:10px;">
        <h2 style="color:#ffc107; margin:0; font-size:16px;">ABSI</h2>
        <select id="tokenSelector" onchange="updateChart()" style="background:#2b3139; color:#fff; border:1px solid #474d57; border-radius:4px;">
            <option value="0x55d398326f99059ff775485246999027b3197955">USDT/BNB</option>
            <option value="0x6b744158428587d5b546304a0e980a3c2670e309">ABSI/USDT</option>
        </select>
    </div>
    <button id="installBtn" class="install-btn">تثبيت التطبيق</button>
</div>

<div class="container">
    <iframe id="tradingChart" src="https://www.geckoterminal.com/bsc/pools/0x55d398326f99059ff775485246999027b3197955?embed=1"></iframe>
    <iframe id="swapWidget" src="https://pancakeswap.finance/swap?outputCurrency=0x55d398326f99059ff775485246999027b3197955&theme=dark"></iframe>
</div>

<script>
    function updateChart() {
        const addr = document.getElementById('tokenSelector').value;
        document.getElementById('tradingChart').src = `https://www.geckoterminal.com/bsc/pools/${addr}?embed=1`;
        document.getElementById('swapWidget').src = `https://pancakeswap.finance/swap?outputCurrency=${addr}&theme=dark`;
    }

    // كود زر التثبيت
    let deferredPrompt;
    const installBtn = document.getElementById('installBtn');

    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        installBtn.style.display = 'block'; // أظهر الزر للمستخدم
    });

    installBtn.addEventListener('click', async () => {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            if (outcome === 'accepted') installBtn.style.display = 'none';
            deferredPrompt = null;
        }
    });
</script>
</body>
</html>
